{% extends "base.html" %}
{% load pages_tags mezzanine_tags i18n future staticfiles %}

{% block main %}

    <div class="row">
        <div class="col-md-offset-5 col-md-2">
            <form method="GET">
                Saison: <select id="season_select">
                    <option value="1314">2013-2014</option>
                    <option value="1213">2012-2013</option>
                    <option value="1112">2011-2012</option>
                </select>
            </form>
        </div>
    </div>

<!-- Nav tabs -->
<ul id="statsTab" class="nav nav-tabs" role="tablist">
{% for game_type, stats in sections.items %}

  {% if stats|length > 0 %}

  <li {% if game_type == active %}class="active"{% endif %}>
      <a href="#{{ game_type }}" role="tab" data-toggle="tab">{{ game_type }}</a>
  </li>

  {% endif %}

{% endfor %}
</ul>

<!-- Tab panes -->
<div class="tab-content">
{% for game_type, stats in sections.items %}

  {% if stats|length > 0 %}

  <div class="tab-pane{% if game_type == active %} active{% endif %} fade" id="{{ game_type }}">
    <div class="table-responsive">
        <table class="table table-striped stats">
            <thead>
                <tr>
                    <th class="row-nr">#</th>
                                <th class="row-name">Name</th>
                                <th class="row-gp"><a href="#" id="tooltip" title="Spiele">S</a></th>
                                <th class="row-goal"><a href="#" id="tooltip" title="Goals">G</a></th>
                                <th class="row-assist"><a href="#" id="tooltip" title="Assists">A</a></th>
                                <th class="row-points"><a href="#" id="tooltip" title="Punkte">P</a></th>
                                <th class="row-points_avg"><a href="#" id="tooltip" title="Punktedurchschnitt pro Spiel">&Oslash;P</a></th>
                                <th class="row-pm"><a href="#" id="tooltip" title="Strafminuten">PM</a></th>
                                <th class="row-pmg_avg"><a href="#" id="tooltip" title="Strafminuten pro Spiel">&Oslash;PM</a></th>
                </tr>
            </thead>
            <tbody>
                 {% for stat in stats %}
                            <tr>
                                <td>{{ stat.player.number|default_if_none:"-" }}</td>
                                <td><a href="{% url 'player' stat.player.pk %}">{{ stat.player }}</a></td>
                                 <td>{{ stat.gp }}</td>
                                <td>{{ stat.goal }}</td>
                                <td>{{ stat.assist }}</td>
                                <td><strong>{{ stat.points }}</strong></td>
                                <td>{{ stat.points_avg|floatformat:2 }}</td>
                                <td>{{ stat.pm }}</td>
                                <td>{{ stat.pm_avg|floatformat:2}}</td>
                            </tr>
                            {% endfor %}
            </tbody>
        </table>
    </div>
   </div>
    {% endif %}
{% endfor %}
</div>

{% endblock %}

{% block extra_js %}

<script>
$(document).ready(function() {
    $('#statsTab a').click(function (e) {
        window.location.hash = this.href.split('#')[1];
        e.preventDefault();
        $(this).tab('show');
    });

    // Javascript to enable link to tab
    var url = document.location.toString();
    if (url.match('#')) {
        $('.nav-tabs a[href=#'+url.split('#')[1]+']').tab('show');
    }
    else {
        $('.nav-tabs a[href=#all]').tab('show');
    }
})
</script>

{% endblock %}